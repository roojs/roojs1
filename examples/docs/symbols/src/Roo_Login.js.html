<html><head><title>../roojs1/Roo/Login.js</title><link rel="stylesheet" type="text/css" href="../../../css/highlight-js.css"/></head><body class="highlightpage"><code class="jsdoc-pretty"><span class="jsdoc-comment">//&lt;script type=&quot;text/javascript&quot;&gt;


/**
 * @class Roo.Login
 * @extends Roo.LayoutDialog
 * A generic Login Dialog..... - only one needed in theory!?!?
 *
 * Fires XComponent builder on success...
 * 
 * Sends 
 *    username,password, lang = for login actions.
 *    check = 1 for periodic checking that sesion is valid.
 *    passwordRequest = email request password
 *    logout = 1 = to logout
 * 
 * Affects: (this id=&quot;????&quot; elements)
 *   loading  (removed) (used to indicate application is loading)
 *   loading-mask (hides) (used to hide application when it's building loading)
 *   
 * 
 * Usage: 
 *    
 * 
 * Myapp.login = Roo.Login({
     url: xxxx,
   
     realm : 'Myapp', 
     
     
     method : 'POST',
     
     
     * 
 })
 * 
 * 
 * 
 **/
 
</span><span class="jsdoc-var">Roo.Login </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">cfg</span><span class="jsdoc-syntax">)
{
    </span><span class="jsdoc-var">this.addEvents</span><span class="jsdoc-syntax">({
        </span><span class="jsdoc-string">'refreshed' </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">true
    </span><span class="jsdoc-syntax">});
    
    </span><span class="jsdoc-var">Roo.apply</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this</span><span class="jsdoc-syntax">,</span><span class="jsdoc-var">cfg</span><span class="jsdoc-syntax">);
    
    </span><span class="jsdoc-var">Roo.onReady</span><span class="jsdoc-syntax">(</span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">() {
        </span><span class="jsdoc-var">this.onLoad</span><span class="jsdoc-syntax">();
    }, </span><span class="jsdoc-var">this</span><span class="jsdoc-syntax">);
    </span><span class="jsdoc-comment">// call parent..
    
   
    </span><span class="jsdoc-var">Roo.Login.superclass.constructor.call</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">this</span><span class="jsdoc-syntax">);
    </span><span class="jsdoc-comment">//this.addxtype(this.items[0]);
    
    
</span><span class="jsdoc-syntax">}


</span><span class="jsdoc-var">Roo.extend</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">Roo.Login</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">Roo.LayoutDialog</span><span class="jsdoc-syntax">, {
    
    </span><span class="jsdoc-comment">/**
     * @cfg {String} method
     * Method used to query for login details.
     */
    
    </span><span class="jsdoc-var">method </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'POST'</span><span class="jsdoc-syntax">,
    </span><span class="jsdoc-comment">/**
     * @cfg {String} url
     * URL to query login data. - eg. baseURL + '/Login.php'
     */
    </span><span class="jsdoc-var">url </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">''</span><span class="jsdoc-syntax">,
    
    </span><span class="jsdoc-comment">/**
     * @property user
     * The user data - if user.id &lt; 0 then login will be bypassed. (used for inital setup situation.
     * @type {Object} 
     */
    </span><span class="jsdoc-var">user </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">,
    </span><span class="jsdoc-comment">/**
     * @property checkFails
     * Number of times we have attempted to get authentication check, and failed.
     * @type {Number} 
     */
    </span><span class="jsdoc-var">checkFails </span><span class="jsdoc-syntax">: 0,
      </span><span class="jsdoc-comment">/**
     * @property intervalID
     * The window interval that does the constant login checking.
     * @type {Number} 
     */
    </span><span class="jsdoc-var">intervalID </span><span class="jsdoc-syntax">: 0,
    
    
    </span><span class="jsdoc-var">onLoad </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">() </span><span class="jsdoc-comment">// called on page load...
    </span><span class="jsdoc-syntax">{
        </span><span class="jsdoc-comment">// load 
         
        </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">Roo.get</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'loading'</span><span class="jsdoc-syntax">)) { </span><span class="jsdoc-comment">// clear any loading indicator..
            </span><span class="jsdoc-var">Roo.get</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'loading'</span><span class="jsdoc-syntax">)</span><span class="jsdoc-var">.remove</span><span class="jsdoc-syntax">();
        }
        
        </span><span class="jsdoc-comment">//this.switchLang('en'); // set the language to english..
       
        </span><span class="jsdoc-var">this.check</span><span class="jsdoc-syntax">({
            </span><span class="jsdoc-var">success</span><span class="jsdoc-syntax">:  </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">opts</span><span class="jsdoc-syntax">)  {  </span><span class="jsdoc-comment">// check successfull...
            
                </span><span class="jsdoc-keyword">var </span><span class="jsdoc-var">res </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">this.processResponse</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response</span><span class="jsdoc-syntax">);
                </span><span class="jsdoc-var">this.checkFails </span><span class="jsdoc-syntax">=0;
                </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(!</span><span class="jsdoc-var">res.success</span><span class="jsdoc-syntax">) { </span><span class="jsdoc-comment">// error!
                    </span><span class="jsdoc-var">this.checkFails </span><span class="jsdoc-syntax">= 5;
                    </span><span class="jsdoc-comment">//console.log('call failure');
                    </span><span class="jsdoc-keyword">return </span><span class="jsdoc-var">this.failure</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response</span><span class="jsdoc-syntax">,</span><span class="jsdoc-var">opts</span><span class="jsdoc-syntax">);
                }
                
                </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(!</span><span class="jsdoc-var">res.data.id</span><span class="jsdoc-syntax">) { </span><span class="jsdoc-comment">// id=0 == login failure.
                    </span><span class="jsdoc-keyword">return </span><span class="jsdoc-var">this.show</span><span class="jsdoc-syntax">();
                }
                
                              
                        </span><span class="jsdoc-comment">//console.log(success);
                </span><span class="jsdoc-var">this.fillAuth</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">res.data</span><span class="jsdoc-syntax">);   
                </span><span class="jsdoc-var">this.checkFails </span><span class="jsdoc-syntax">=0;
                </span><span class="jsdoc-var">Roo.XComponent.build</span><span class="jsdoc-syntax">();
            },
            </span><span class="jsdoc-var">failure </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">this.show
        </span><span class="jsdoc-syntax">});
        
    }, 
    
    
    </span><span class="jsdoc-var">check</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">cfg</span><span class="jsdoc-syntax">) </span><span class="jsdoc-comment">// called every so often to refresh cookie etc..
    </span><span class="jsdoc-syntax">{
        </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">cfg.again</span><span class="jsdoc-syntax">) { </span><span class="jsdoc-comment">// could be undefined..
            </span><span class="jsdoc-var">this.checkFails</span><span class="jsdoc-syntax">++;
        } </span><span class="jsdoc-keyword">else </span><span class="jsdoc-syntax">{
            </span><span class="jsdoc-var">this.checkFails </span><span class="jsdoc-syntax">= 0;
        }
        </span><span class="jsdoc-keyword">var </span><span class="jsdoc-var">_this </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">this</span><span class="jsdoc-syntax">;
        </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this.sending</span><span class="jsdoc-syntax">) {
            </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">( </span><span class="jsdoc-var">this.checkFails </span><span class="jsdoc-syntax">&gt; 4) {
                </span><span class="jsdoc-var">Roo.MessageBox.alert</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Error&quot;</span><span class="jsdoc-syntax">,  
                    </span><span class="jsdoc-string">&quot;Error getting authentication status. - try reloading, or wait a while&quot;</span><span class="jsdoc-syntax">, </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">() {
                        </span><span class="jsdoc-var">_this.sending </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">;
                    }); 
                </span><span class="jsdoc-keyword">return</span><span class="jsdoc-syntax">;
            }
            </span><span class="jsdoc-var">cfg.again </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">true</span><span class="jsdoc-syntax">;
            </span><span class="jsdoc-var">_this.check.defer</span><span class="jsdoc-syntax">(10000, </span><span class="jsdoc-var">_this</span><span class="jsdoc-syntax">, [ </span><span class="jsdoc-var">cfg </span><span class="jsdoc-syntax">]); </span><span class="jsdoc-comment">// check in 10 secs.
            </span><span class="jsdoc-keyword">return</span><span class="jsdoc-syntax">;
        }
        </span><span class="jsdoc-var">this.sending </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">true</span><span class="jsdoc-syntax">;
        
        </span><span class="jsdoc-var">Roo.Ajax.request</span><span class="jsdoc-syntax">({  
            </span><span class="jsdoc-var">url</span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">this.url</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">params</span><span class="jsdoc-syntax">: {
                </span><span class="jsdoc-var">getAuthUser</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">true
            </span><span class="jsdoc-syntax">},  
            </span><span class="jsdoc-var">method</span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">this.method</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">success</span><span class="jsdoc-syntax">:  </span><span class="jsdoc-var">cfg.success </span><span class="jsdoc-syntax">|| </span><span class="jsdoc-var">this.success</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">failure </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">cfg.failure </span><span class="jsdoc-syntax">|| </span><span class="jsdoc-var">this.failure</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">scope </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">this</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">callCfg </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">cfg
              
        </span><span class="jsdoc-syntax">});  
    }, 
    
    
    </span><span class="jsdoc-var">logout</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">()
    {
        </span><span class="jsdoc-var">window.onbeforeunload </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">() { }; </span><span class="jsdoc-comment">// false does not work for IE..
        </span><span class="jsdoc-var">this.user </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">;
        </span><span class="jsdoc-keyword">var </span><span class="jsdoc-var">_this </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">this</span><span class="jsdoc-syntax">;
        
        </span><span class="jsdoc-var">Roo.Ajax.request</span><span class="jsdoc-syntax">({  
            </span><span class="jsdoc-var">url</span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">this.url</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">params</span><span class="jsdoc-syntax">: {
                </span><span class="jsdoc-var">logout</span><span class="jsdoc-syntax">: 1
            },  
            </span><span class="jsdoc-var">method</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'GET'</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">failure </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">() {
                </span><span class="jsdoc-var">Roo.MessageBox.alert</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Error&quot;</span><span class="jsdoc-syntax">, </span><span class="jsdoc-string">&quot;Error logging out. - continuing anyway.&quot;</span><span class="jsdoc-syntax">, </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">() {
                    </span><span class="jsdoc-var">document.location </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">document.location.toString</span><span class="jsdoc-syntax">() + </span><span class="jsdoc-string">'?ts=' </span><span class="jsdoc-syntax">+ </span><span class="jsdoc-var">Math.random</span><span class="jsdoc-syntax">();
                });
                
            },
            </span><span class="jsdoc-var">success </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">() {
                </span><span class="jsdoc-var">_this.user </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">;
                </span><span class="jsdoc-var">this.checkFails </span><span class="jsdoc-syntax">=0;
                </span><span class="jsdoc-comment">// fixme..
                </span><span class="jsdoc-var">document.location </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">document.location.toString</span><span class="jsdoc-syntax">() + </span><span class="jsdoc-string">'?ts=' </span><span class="jsdoc-syntax">+ </span><span class="jsdoc-var">Math.random</span><span class="jsdoc-syntax">();
            }
              
              
        }); 
    },
    
    </span><span class="jsdoc-var">processResponse </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response</span><span class="jsdoc-syntax">)
    {
        </span><span class="jsdoc-keyword">var </span><span class="jsdoc-var">res </span><span class="jsdoc-syntax">= </span><span class="jsdoc-string">''</span><span class="jsdoc-syntax">;
        </span><span class="jsdoc-keyword">try </span><span class="jsdoc-syntax">{
            </span><span class="jsdoc-var">res </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">Roo.decode</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response.responseText</span><span class="jsdoc-syntax">);
            </span><span class="jsdoc-comment">// oops...
            </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-keyword">typeof</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">res</span><span class="jsdoc-syntax">) != </span><span class="jsdoc-string">'object'</span><span class="jsdoc-syntax">) {
                </span><span class="jsdoc-var">res </span><span class="jsdoc-syntax">= { </span><span class="jsdoc-var">success </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">errorMsg </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">res</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">errors </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">true </span><span class="jsdoc-syntax">};
            }
            </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-keyword">typeof</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">res.success</span><span class="jsdoc-syntax">) == </span><span class="jsdoc-string">'undefined'</span><span class="jsdoc-syntax">) {
                </span><span class="jsdoc-var">res.success </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">;
            }
            
        } </span><span class="jsdoc-keyword">catch</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">e</span><span class="jsdoc-syntax">) {
            </span><span class="jsdoc-var">res </span><span class="jsdoc-syntax">= { </span><span class="jsdoc-var">success </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">,  </span><span class="jsdoc-var">errorMsg </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">response.responseText</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">errors </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">true </span><span class="jsdoc-syntax">};
        }
        </span><span class="jsdoc-keyword">return </span><span class="jsdoc-var">res</span><span class="jsdoc-syntax">;
    },
    
    </span><span class="jsdoc-var">success </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">opts</span><span class="jsdoc-syntax">)  </span><span class="jsdoc-comment">// check successfull...
    </span><span class="jsdoc-syntax">{  
        </span><span class="jsdoc-var">this.sending </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">;
        </span><span class="jsdoc-keyword">var </span><span class="jsdoc-var">res </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">this.processResponse</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response</span><span class="jsdoc-syntax">);
        </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(!</span><span class="jsdoc-var">res.success</span><span class="jsdoc-syntax">) {
            </span><span class="jsdoc-keyword">return </span><span class="jsdoc-var">this.failure</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">opts</span><span class="jsdoc-syntax">);
        }
        </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(!</span><span class="jsdoc-var">res.data </span><span class="jsdoc-syntax">|| !</span><span class="jsdoc-var">res.data.id</span><span class="jsdoc-syntax">) {
            </span><span class="jsdoc-keyword">return </span><span class="jsdoc-var">this.failure</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response</span><span class="jsdoc-syntax">,</span><span class="jsdoc-var">opts</span><span class="jsdoc-syntax">);
        }
        </span><span class="jsdoc-comment">//console.log(res);
        </span><span class="jsdoc-var">this.fillAuth</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">res.data</span><span class="jsdoc-syntax">);
        
        </span><span class="jsdoc-var">this.checkFails </span><span class="jsdoc-syntax">=0;
        
    },
    
    
    </span><span class="jsdoc-var">failure </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">opts</span><span class="jsdoc-syntax">) </span><span class="jsdoc-comment">// called if login 'check' fails.. (causes re-check)
    </span><span class="jsdoc-syntax">{
        </span><span class="jsdoc-var">this.authUser </span><span class="jsdoc-syntax">= -1;
        </span><span class="jsdoc-var">this.sending </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">;
        </span><span class="jsdoc-keyword">var </span><span class="jsdoc-var">res </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">this.processResponse</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response</span><span class="jsdoc-syntax">);
        </span><span class="jsdoc-comment">//console.log(res);
        </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">( </span><span class="jsdoc-var">this.checkFails </span><span class="jsdoc-syntax">&gt; 2) {
        
            </span><span class="jsdoc-var">Roo.MessageBox.alert</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Error&quot;</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">res.errorMsg </span><span class="jsdoc-syntax">? </span><span class="jsdoc-var">res.errorMsg </span><span class="jsdoc-syntax">: 
                </span><span class="jsdoc-string">&quot;Error getting authentication status. - try reloading&quot;</span><span class="jsdoc-syntax">); 
            </span><span class="jsdoc-keyword">return</span><span class="jsdoc-syntax">;
        }
        </span><span class="jsdoc-var">opts.callCfg.again </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">true</span><span class="jsdoc-syntax">;
        </span><span class="jsdoc-var">this.check.defer</span><span class="jsdoc-syntax">(1000, </span><span class="jsdoc-var">this</span><span class="jsdoc-syntax">, [ </span><span class="jsdoc-var">opts.callCfg </span><span class="jsdoc-syntax">]);
        </span><span class="jsdoc-keyword">return</span><span class="jsdoc-syntax">;  
    },
    
    
    
    </span><span class="jsdoc-var">fillAuth</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">au</span><span class="jsdoc-syntax">) {
        </span><span class="jsdoc-var">this.startAuthCheck</span><span class="jsdoc-syntax">();
        </span><span class="jsdoc-var">this.authUserId </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">au.id</span><span class="jsdoc-syntax">;
        </span><span class="jsdoc-var">this.authUser </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">au</span><span class="jsdoc-syntax">;
        </span><span class="jsdoc-var">this.lastChecked </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">new </span><span class="jsdoc-var">Date</span><span class="jsdoc-syntax">();
        </span><span class="jsdoc-var">this.fireEvent</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'refreshed'</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">au</span><span class="jsdoc-syntax">);
        </span><span class="jsdoc-comment">//Pman.Tab.FaxQueue.newMaxId(au.faxMax);
        //Pman.Tab.FaxTab.setTitle(au.faxNumPending);
        </span><span class="jsdoc-var">au.lang </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">au.lang </span><span class="jsdoc-syntax">|| </span><span class="jsdoc-string">'en'</span><span class="jsdoc-syntax">;
        </span><span class="jsdoc-comment">//this.switchLang(Roo.state.Manager.get('Pman.Login.lang', 'en'));
        </span><span class="jsdoc-var">Roo.state.Manager.set</span><span class="jsdoc-syntax">( </span><span class="jsdoc-var">this.realm </span><span class="jsdoc-syntax">+ </span><span class="jsdoc-string">'lang' </span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">au.lang</span><span class="jsdoc-syntax">);
        </span><span class="jsdoc-var">this.switchLang</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">au.lang </span><span class="jsdoc-syntax">);
        
     
        </span><span class="jsdoc-comment">// open system... - -on setyp..
        </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this.authUserId  </span><span class="jsdoc-syntax">&lt; 0) {
            </span><span class="jsdoc-var">Roo.MessageBox.alert</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Warning&quot;</span><span class="jsdoc-syntax">, 
                </span><span class="jsdoc-string">&quot;This is an open system - please set up a admin user with a password.&quot;</span><span class="jsdoc-syntax">);  
        }
         
        </span><span class="jsdoc-comment">//Pman.onload(); // which should do nothing if it's a re-auth result...
        
             
    </span><span class="jsdoc-syntax">},
    
    </span><span class="jsdoc-var">startAuthCheck </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">() </span><span class="jsdoc-comment">// starter for timeout checking..
    </span><span class="jsdoc-syntax">{
        </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this.intervalID</span><span class="jsdoc-syntax">) { </span><span class="jsdoc-comment">// timer already in place...
            </span><span class="jsdoc-keyword">return false</span><span class="jsdoc-syntax">;
        }
        </span><span class="jsdoc-keyword">var </span><span class="jsdoc-var">_this </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">this</span><span class="jsdoc-syntax">;
        </span><span class="jsdoc-var">this.intervalID </span><span class="jsdoc-syntax">=  </span><span class="jsdoc-var">window.setInterval</span><span class="jsdoc-syntax">(</span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">() {
              </span><span class="jsdoc-var">_this.check</span><span class="jsdoc-syntax">(</span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">);
            }, 120000); </span><span class="jsdoc-comment">// every 120 secs = 2mins..
        
        
    </span><span class="jsdoc-syntax">},
         
    
    </span><span class="jsdoc-var">switchLang </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">lang</span><span class="jsdoc-syntax">) 
    {
        </span><span class="jsdoc-var">_T </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">typeof</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">_T</span><span class="jsdoc-syntax">) == </span><span class="jsdoc-string">'undefined' </span><span class="jsdoc-syntax">? </span><span class="jsdoc-keyword">false </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">_T</span><span class="jsdoc-syntax">;
          </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(!</span><span class="jsdoc-var">_T </span><span class="jsdoc-syntax">|| !</span><span class="jsdoc-var">lang.length</span><span class="jsdoc-syntax">) {
            </span><span class="jsdoc-keyword">return</span><span class="jsdoc-syntax">;
        }
        
        </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(!</span><span class="jsdoc-var">_T </span><span class="jsdoc-syntax">&amp;&amp; </span><span class="jsdoc-var">lang </span><span class="jsdoc-syntax">!= </span><span class="jsdoc-string">'en'</span><span class="jsdoc-syntax">) {
            </span><span class="jsdoc-var">Roo.MessageBox.alert</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Sorry&quot;</span><span class="jsdoc-syntax">, </span><span class="jsdoc-string">&quot;Language not available yet (&quot; </span><span class="jsdoc-syntax">+ </span><span class="jsdoc-var">lang </span><span class="jsdoc-syntax">+</span><span class="jsdoc-string">')'</span><span class="jsdoc-syntax">);
            </span><span class="jsdoc-keyword">return</span><span class="jsdoc-syntax">;
        }
        
        </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-keyword">typeof</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">_T.en</span><span class="jsdoc-syntax">) == </span><span class="jsdoc-string">'undefined'</span><span class="jsdoc-syntax">) {
            </span><span class="jsdoc-var">_T.en </span><span class="jsdoc-syntax">= {};
            </span><span class="jsdoc-var">Roo.apply</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">_T.en</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">_T</span><span class="jsdoc-syntax">);
        }
        
        </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-keyword">typeof</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">_T</span><span class="jsdoc-syntax">[</span><span class="jsdoc-var">lang</span><span class="jsdoc-syntax">]) == </span><span class="jsdoc-string">'undefined'</span><span class="jsdoc-syntax">) {
            </span><span class="jsdoc-var">Roo.MessageBox.alert</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Sorry&quot;</span><span class="jsdoc-syntax">, </span><span class="jsdoc-string">&quot;Language not available yet (&quot; </span><span class="jsdoc-syntax">+ </span><span class="jsdoc-var">lang </span><span class="jsdoc-syntax">+</span><span class="jsdoc-string">')'</span><span class="jsdoc-syntax">);
            </span><span class="jsdoc-keyword">return</span><span class="jsdoc-syntax">;
        }
        
        
        </span><span class="jsdoc-var">Roo.apply</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">_T</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">_T</span><span class="jsdoc-syntax">[</span><span class="jsdoc-var">lang</span><span class="jsdoc-syntax">]);
        </span><span class="jsdoc-comment">// just need to set the text values for everything...
        </span><span class="jsdoc-keyword">var </span><span class="jsdoc-var">_this </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">this</span><span class="jsdoc-syntax">;
        </span><span class="jsdoc-comment">/* this will not work ...
        if (this.form) { 
            
               
            function formLabel(name, val) {
                _this.form.findField(name).fieldEl.child('label').dom.innerHTML  = val;
            }
            
            formLabel('password', &quot;Password&quot;+':');
            formLabel('username', &quot;Email Address&quot;+':');
            formLabel('lang', &quot;Language&quot;+':');
            this.dialog.setTitle(&quot;Login&quot;);
            this.dialog.buttons[0].setText(&quot;Forgot Password&quot;);
            this.dialog.buttons[1].setText(&quot;Login&quot;);
        }
        */
        
        
    </span><span class="jsdoc-syntax">},
    
    
    </span><span class="jsdoc-var">title</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;Login&quot;</span><span class="jsdoc-syntax">,
    </span><span class="jsdoc-var">modal</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">true</span><span class="jsdoc-syntax">,
    </span><span class="jsdoc-var">width</span><span class="jsdoc-syntax">:  350,
    </span><span class="jsdoc-comment">//height: 230,
    </span><span class="jsdoc-var">height</span><span class="jsdoc-syntax">: 180,
    </span><span class="jsdoc-var">shadow</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">true</span><span class="jsdoc-syntax">,
    </span><span class="jsdoc-var">minWidth</span><span class="jsdoc-syntax">:200,
    </span><span class="jsdoc-var">minHeight</span><span class="jsdoc-syntax">:180,
    </span><span class="jsdoc-comment">//proxyDrag: true,
    </span><span class="jsdoc-var">closable</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">,
    </span><span class="jsdoc-var">draggable</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">,
    </span><span class="jsdoc-var">collapsible</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">,
    </span><span class="jsdoc-var">resizable</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">,
    </span><span class="jsdoc-var">center</span><span class="jsdoc-syntax">: {  </span><span class="jsdoc-comment">// needed??
        </span><span class="jsdoc-var">autoScroll</span><span class="jsdoc-syntax">:</span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">,
        </span><span class="jsdoc-var">titlebar</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">,
       </span><span class="jsdoc-comment">// tabPosition: 'top',
        </span><span class="jsdoc-var">hideTabs</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">true</span><span class="jsdoc-syntax">,
        </span><span class="jsdoc-var">closeOnTab</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">true</span><span class="jsdoc-syntax">,
        </span><span class="jsdoc-var">alwaysShowTabs</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">false
    </span><span class="jsdoc-syntax">} ,
    </span><span class="jsdoc-var">listeners </span><span class="jsdoc-syntax">: {
        
        </span><span class="jsdoc-var">show  </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">dlg</span><span class="jsdoc-syntax">)
        {
            </span><span class="jsdoc-comment">//console.log(this);
            </span><span class="jsdoc-var">this.form </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">this.layout.getRegion</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'center'</span><span class="jsdoc-syntax">)</span><span class="jsdoc-var">.activePanel.form</span><span class="jsdoc-syntax">;
            </span><span class="jsdoc-var">this.form.dialog </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">dlg</span><span class="jsdoc-syntax">;
            </span><span class="jsdoc-var">this.buttons</span><span class="jsdoc-syntax">[0]</span><span class="jsdoc-var">.form </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">this.form</span><span class="jsdoc-syntax">;
            </span><span class="jsdoc-var">this.buttons</span><span class="jsdoc-syntax">[0]</span><span class="jsdoc-var">.dialog </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">dlg</span><span class="jsdoc-syntax">;
            </span><span class="jsdoc-var">this.buttons</span><span class="jsdoc-syntax">[1]</span><span class="jsdoc-var">.form </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">this.form</span><span class="jsdoc-syntax">;
            </span><span class="jsdoc-var">this.buttons</span><span class="jsdoc-syntax">[1]</span><span class="jsdoc-var">.dialog </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">dlg</span><span class="jsdoc-syntax">;
           
           </span><span class="jsdoc-comment">//this.resizeToLogo.defer(1000,this);
            // this is all related to resizing for logos..
            //var sz = Roo.get(Pman.Login.form.el.query('img')[0]).getSize();
           //// if (!sz) {
             //   this.resizeToLogo.defer(1000,this);
             //   return;
           // }
            //var w = Ext.lib.Dom.getViewWidth() - 100;
            //var h = Ext.lib.Dom.getViewHeight() - 100;
            //this.resizeTo(Math.max(350, Math.min(sz.width + 30, w)),Math.min(sz.height+200, h));
            //this.center();
            </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this.disabled</span><span class="jsdoc-syntax">) {
                </span><span class="jsdoc-var">this.hide</span><span class="jsdoc-syntax">();
                </span><span class="jsdoc-keyword">return</span><span class="jsdoc-syntax">;
            }
            
            </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this.user.id </span><span class="jsdoc-syntax">&lt; 0) { </span><span class="jsdoc-comment">// used for inital setup situations.
                </span><span class="jsdoc-keyword">return</span><span class="jsdoc-syntax">;
            }
            
            </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this.intervalID</span><span class="jsdoc-syntax">) {
                </span><span class="jsdoc-comment">// remove the timer
                </span><span class="jsdoc-var">window.clearInterval</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this.intervalID</span><span class="jsdoc-syntax">);
                </span><span class="jsdoc-var">this.intervalID </span><span class="jsdoc-syntax">= </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">;
            }
            
            
            </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">Roo.get</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'loading'</span><span class="jsdoc-syntax">)) {
                </span><span class="jsdoc-var">Roo.get</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'loading'</span><span class="jsdoc-syntax">)</span><span class="jsdoc-var">.remove</span><span class="jsdoc-syntax">();
            }
            </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">Roo.get</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'loading-mask'</span><span class="jsdoc-syntax">)) {
                </span><span class="jsdoc-var">Roo.get</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'loading-mask'</span><span class="jsdoc-syntax">)</span><span class="jsdoc-var">.hide</span><span class="jsdoc-syntax">();
            }
            
            </span><span class="jsdoc-comment">//incomming._node = tnode;
            </span><span class="jsdoc-var">this.form.reset</span><span class="jsdoc-syntax">();
            </span><span class="jsdoc-comment">//this.dialog.modal = !modal;
            //this.dialog.show();
            </span><span class="jsdoc-var">this.el.unmask</span><span class="jsdoc-syntax">(); 
            
            
            </span><span class="jsdoc-var">this.form.setValues</span><span class="jsdoc-syntax">({
                </span><span class="jsdoc-string">'username' </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">Roo.state.Manager.get</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this.realm </span><span class="jsdoc-syntax">+ </span><span class="jsdoc-string">'.username'</span><span class="jsdoc-syntax">, </span><span class="jsdoc-string">''</span><span class="jsdoc-syntax">),
                </span><span class="jsdoc-string">'lang' </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">Roo.state.Manager.get</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this.realm </span><span class="jsdoc-syntax">+ </span><span class="jsdoc-string">'.lang'</span><span class="jsdoc-syntax">, </span><span class="jsdoc-string">'en'</span><span class="jsdoc-syntax">)
            });
            
            </span><span class="jsdoc-var">this.switchLang</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">Roo.state.Manager.get</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this.realm </span><span class="jsdoc-syntax">+ </span><span class="jsdoc-string">'.lang'</span><span class="jsdoc-syntax">, </span><span class="jsdoc-string">'en'</span><span class="jsdoc-syntax">));
            </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">this.form.findField</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'username'</span><span class="jsdoc-syntax">)</span><span class="jsdoc-var">.getValue</span><span class="jsdoc-syntax">()</span><span class="jsdoc-var">.length </span><span class="jsdoc-syntax">&gt; 0 ){
                </span><span class="jsdoc-var">this.form.findField</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'password'</span><span class="jsdoc-syntax">)</span><span class="jsdoc-var">.focus</span><span class="jsdoc-syntax">();
            } </span><span class="jsdoc-keyword">else </span><span class="jsdoc-syntax">{
               </span><span class="jsdoc-var">this.form.findField</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'username'</span><span class="jsdoc-syntax">)</span><span class="jsdoc-var">.focus</span><span class="jsdoc-syntax">();
            }
    
        }
    },
    </span><span class="jsdoc-var">items </span><span class="jsdoc-syntax">: [
         {
       
            </span><span class="jsdoc-var">xtype </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'ContentPanel'</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">xns </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">Roo</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">region</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'center'</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">fitToFrame </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">true</span><span class="jsdoc-syntax">,
            
            </span><span class="jsdoc-var">items </span><span class="jsdoc-syntax">: [
    
                {
               
                    </span><span class="jsdoc-var">xtype </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'Form'</span><span class="jsdoc-syntax">,
                    </span><span class="jsdoc-var">xns </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">Roo.form</span><span class="jsdoc-syntax">,
                    </span><span class="jsdoc-var">labelWidth</span><span class="jsdoc-syntax">: 100,
                    </span><span class="jsdoc-var">style </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'margin: 10px;'</span><span class="jsdoc-syntax">,
                    
                    </span><span class="jsdoc-var">listeners </span><span class="jsdoc-syntax">: {
                        </span><span class="jsdoc-var">actionfailed </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">f</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">act</span><span class="jsdoc-syntax">) {
                            </span><span class="jsdoc-comment">// form can return { errors: .... }
                                
                            //act.result.errors // invalid form element list...
                            //act.result.errorMsg// invalid form element list...
                            
                            </span><span class="jsdoc-var">this.dialog.el.unmask</span><span class="jsdoc-syntax">();
                            </span><span class="jsdoc-var">Roo.MessageBox.alert</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Error&quot;</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">act.result.errorMsg </span><span class="jsdoc-syntax">? </span><span class="jsdoc-var">act.result.errorMsg </span><span class="jsdoc-syntax">: 
                                        </span><span class="jsdoc-string">&quot;Login failed - communication error - try again.&quot;</span><span class="jsdoc-syntax">);
                                      
                        },
                        </span><span class="jsdoc-var">actioncomplete</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">re</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">act</span><span class="jsdoc-syntax">) {
                             
                            </span><span class="jsdoc-var">Roo.state.Manager.set</span><span class="jsdoc-syntax">(
                                </span><span class="jsdoc-var">this.dialog.realm </span><span class="jsdoc-syntax">+ </span><span class="jsdoc-string">'.username'</span><span class="jsdoc-syntax">,  
                                    </span><span class="jsdoc-var">this.findField</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'username'</span><span class="jsdoc-syntax">)</span><span class="jsdoc-var">.getValue</span><span class="jsdoc-syntax">()
                            );
                            </span><span class="jsdoc-var">Roo.state.Manager.set</span><span class="jsdoc-syntax">(
                                </span><span class="jsdoc-var">this.dialog.realm </span><span class="jsdoc-syntax">+ </span><span class="jsdoc-string">'.lang'</span><span class="jsdoc-syntax">,  
                                </span><span class="jsdoc-var">this.findField</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'lang'</span><span class="jsdoc-syntax">)</span><span class="jsdoc-var">.getValue</span><span class="jsdoc-syntax">() 
                            );
                            
                            </span><span class="jsdoc-var">this.dialog.fillAuth</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">act.result.data</span><span class="jsdoc-syntax">);
                              
                            </span><span class="jsdoc-var">this.dialog.hide</span><span class="jsdoc-syntax">();
                            
                            </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">Roo.get</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'loading-mask'</span><span class="jsdoc-syntax">)) {
                                </span><span class="jsdoc-var">Roo.get</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'loading-mask'</span><span class="jsdoc-syntax">)</span><span class="jsdoc-var">.show</span><span class="jsdoc-syntax">();
                            }
                            </span><span class="jsdoc-var">Roo.XComponent.build</span><span class="jsdoc-syntax">();
                            
                             
                            
                        }
                    },
                    </span><span class="jsdoc-var">items </span><span class="jsdoc-syntax">: [
                        {
                            </span><span class="jsdoc-var">xtype </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'TextField'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">xns </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">Roo.form</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">fieldLabel</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;Email Address&quot;</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">name</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'username'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">width</span><span class="jsdoc-syntax">:200,
                            </span><span class="jsdoc-var">autoCreate </span><span class="jsdoc-syntax">: {</span><span class="jsdoc-var">tag</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;input&quot;</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">type</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;text&quot;</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">size</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;20&quot;</span><span class="jsdoc-syntax">}
                        },
                        {
                            </span><span class="jsdoc-var">xtype </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'TextField'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">xns </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">Roo.form</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">fieldLabel</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;Password&quot;</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">inputType</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'password'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">name</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'password'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">width</span><span class="jsdoc-syntax">:200,
                            </span><span class="jsdoc-var">autoCreate </span><span class="jsdoc-syntax">: {</span><span class="jsdoc-var">tag</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;input&quot;</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">type</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;text&quot;</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">size</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;20&quot;</span><span class="jsdoc-syntax">},
                            </span><span class="jsdoc-var">listeners </span><span class="jsdoc-syntax">: {
                                </span><span class="jsdoc-var">specialkey </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">e</span><span class="jsdoc-syntax">,</span><span class="jsdoc-var">ev</span><span class="jsdoc-syntax">) {
                                    </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">ev.keyCode </span><span class="jsdoc-syntax">== 13) {
                                        </span><span class="jsdoc-var">this.form.dialog.el.mask</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Logging in&quot;</span><span class="jsdoc-syntax">);
                                        </span><span class="jsdoc-var">this.form.doAction</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'submit'</span><span class="jsdoc-syntax">, {
                                            </span><span class="jsdoc-var">url</span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">this.form.dialog.url</span><span class="jsdoc-syntax">,
                                            </span><span class="jsdoc-var">method</span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">this.form.dialog.method
                                        </span><span class="jsdoc-syntax">});
                                    }
                                }
                            }  
                        },
                        {
                            </span><span class="jsdoc-var">xtype </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'ComboBox'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">xns </span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">Roo.form</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">fieldLabel</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;Language&quot;</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">name </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'langdisp'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">store</span><span class="jsdoc-syntax">: {
                                </span><span class="jsdoc-var">xtype </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'SimpleStore'</span><span class="jsdoc-syntax">,
                                </span><span class="jsdoc-var">fields</span><span class="jsdoc-syntax">: [</span><span class="jsdoc-string">'lang'</span><span class="jsdoc-syntax">, </span><span class="jsdoc-string">'ldisp'</span><span class="jsdoc-syntax">],
                                </span><span class="jsdoc-var">data </span><span class="jsdoc-syntax">: [
                                    [ </span><span class="jsdoc-string">'en'</span><span class="jsdoc-syntax">, </span><span class="jsdoc-string">'English' </span><span class="jsdoc-syntax">],
                                    [ </span><span class="jsdoc-string">'zh_HK' </span><span class="jsdoc-syntax">, </span><span class="jsdoc-string">'\u7E41\u4E2D' </span><span class="jsdoc-syntax">],
                                    [ </span><span class="jsdoc-string">'zh_CN'</span><span class="jsdoc-syntax">, </span><span class="jsdoc-string">'\u7C21\u4E2D' </span><span class="jsdoc-syntax">]
                                ]
                            },
                            
                            </span><span class="jsdoc-var">valueField </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'lang'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">hiddenName</span><span class="jsdoc-syntax">:  </span><span class="jsdoc-string">'lang'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">width</span><span class="jsdoc-syntax">: 200,
                            </span><span class="jsdoc-var">displayField</span><span class="jsdoc-syntax">:</span><span class="jsdoc-string">'ldisp'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">typeAhead</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">editable</span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">false</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">mode</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'local'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">triggerAction</span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'all'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">emptyText</span><span class="jsdoc-syntax">:</span><span class="jsdoc-string">'Select a Language...'</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">selectOnFocus</span><span class="jsdoc-syntax">:</span><span class="jsdoc-keyword">true</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">listeners </span><span class="jsdoc-syntax">: {
                                </span><span class="jsdoc-var">select </span><span class="jsdoc-syntax">:  </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">cb</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">rec</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">ix</span><span class="jsdoc-syntax">) {
                                    </span><span class="jsdoc-var">this.form.switchLang</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">rec.data.lang</span><span class="jsdoc-syntax">);
                                }
                            }
                        
                        }
                    ]
                }
                  
                
            ]
        }
    ],
    </span><span class="jsdoc-var">buttons </span><span class="jsdoc-syntax">: [
        {
            </span><span class="jsdoc-var">xtype </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'Button'</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">xns </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'Roo'</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">text </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;Forgot Password&quot;</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">listeners </span><span class="jsdoc-syntax">: {
                </span><span class="jsdoc-var">click </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">() {
                    </span><span class="jsdoc-comment">//console.log(this);
                    </span><span class="jsdoc-keyword">var </span><span class="jsdoc-var">n </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">this.form.findField</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'username'</span><span class="jsdoc-syntax">)</span><span class="jsdoc-var">.getValue</span><span class="jsdoc-syntax">();
                    </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(!</span><span class="jsdoc-var">n.length</span><span class="jsdoc-syntax">) {
                        </span><span class="jsdoc-var">Roo.MessageBox.alert</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Error&quot;</span><span class="jsdoc-syntax">, </span><span class="jsdoc-string">&quot;Fill in your email address&quot;</span><span class="jsdoc-syntax">);
                        </span><span class="jsdoc-keyword">return</span><span class="jsdoc-syntax">;
                    }
                    </span><span class="jsdoc-var">Roo.Ajax.request</span><span class="jsdoc-syntax">({
                        </span><span class="jsdoc-var">url</span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">this.dialog.url</span><span class="jsdoc-syntax">,
                        </span><span class="jsdoc-var">params</span><span class="jsdoc-syntax">: {
                            </span><span class="jsdoc-var">passwordRequest</span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">n
                        </span><span class="jsdoc-syntax">},
                        </span><span class="jsdoc-var">method</span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">this.dialog.method</span><span class="jsdoc-syntax">,
                        </span><span class="jsdoc-var">success</span><span class="jsdoc-syntax">:  </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response</span><span class="jsdoc-syntax">, </span><span class="jsdoc-var">opts</span><span class="jsdoc-syntax">)  {  </span><span class="jsdoc-comment">// check successfull...
                        
                            </span><span class="jsdoc-keyword">var </span><span class="jsdoc-var">res </span><span class="jsdoc-syntax">= </span><span class="jsdoc-var">this.dialog.processResponse</span><span class="jsdoc-syntax">(</span><span class="jsdoc-var">response</span><span class="jsdoc-syntax">);
                            </span><span class="jsdoc-keyword">if </span><span class="jsdoc-syntax">(!</span><span class="jsdoc-var">res.success</span><span class="jsdoc-syntax">) { </span><span class="jsdoc-comment">// error!
                               </span><span class="jsdoc-var">Roo.MessageBox.alert</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Error&quot; </span><span class="jsdoc-syntax">,
                                    </span><span class="jsdoc-var">res.errorMsg </span><span class="jsdoc-syntax">? </span><span class="jsdoc-var">res.errorMsg  </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;Problem Requesting Password Reset&quot;</span><span class="jsdoc-syntax">);
                               </span><span class="jsdoc-keyword">return</span><span class="jsdoc-syntax">;
                            }
                            </span><span class="jsdoc-var">Roo.MessageBox.alert</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Notice&quot; </span><span class="jsdoc-syntax">,
                                </span><span class="jsdoc-string">&quot;Please check you email for the Password Reset message&quot;</span><span class="jsdoc-syntax">);
                        },
                        </span><span class="jsdoc-var">failure </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function</span><span class="jsdoc-syntax">() {
                            </span><span class="jsdoc-var">Roo.MessageBox.alert</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Error&quot; </span><span class="jsdoc-syntax">, </span><span class="jsdoc-string">&quot;Problem Requesting Password Reset&quot;</span><span class="jsdoc-syntax">);
                        }
                        
                    });
                }
            }
        },
        {
            </span><span class="jsdoc-var">xtype </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'Button'</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">xns </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">'Roo'</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">text </span><span class="jsdoc-syntax">: </span><span class="jsdoc-string">&quot;Login&quot;</span><span class="jsdoc-syntax">,
            </span><span class="jsdoc-var">listeners </span><span class="jsdoc-syntax">: {
                
                </span><span class="jsdoc-var">click </span><span class="jsdoc-syntax">: </span><span class="jsdoc-keyword">function </span><span class="jsdoc-syntax">() {
                        
                    </span><span class="jsdoc-var">this.dialog.el.mask</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">&quot;Logging in&quot;</span><span class="jsdoc-syntax">);
                    </span><span class="jsdoc-var">this.form.doAction</span><span class="jsdoc-syntax">(</span><span class="jsdoc-string">'submit'</span><span class="jsdoc-syntax">, {
                            </span><span class="jsdoc-var">url</span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">this.dialog.url</span><span class="jsdoc-syntax">,
                            </span><span class="jsdoc-var">method</span><span class="jsdoc-syntax">: </span><span class="jsdoc-var">this.dialog.method
                    </span><span class="jsdoc-syntax">});
                }
            }
        }
    ]
  
  
})
 


   </span></code></body></html>